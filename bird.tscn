[gd_scene load_steps=10 format=3 uid="uid://djpe7kex3sduk"]

[ext_resource type="Texture2D" uid="uid://cohodpmks1rtu" path="res://Sunny Land Collection Files/Assets/Characters/Enemies and NPC/flying-bird/Sprites/flying-creature-cycle-skin1.png" id="1_yr30m"]
[ext_resource type="Texture2D" uid="uid://ctvqewnf0yjsy" path="res://Sunny Land Collection Files/Assets/Characters/Enemies and NPC/flying-bird/Sprites/flying-creature-cycle-skin2.png" id="2_2o5yp"]
[ext_resource type="Texture2D" uid="uid://dtlruf3puq5fl" path="res://Sunny Land Collection Files/Assets/Characters/Enemies and NPC/flying-bird/Sprites/flying-creature-cycle-skin3.png" id="3_k3v35"]
[ext_resource type="Texture2D" uid="uid://35ncjx6vpc5e" path="res://Sunny Land Collection Files/Assets/Characters/Enemies and NPC/flying-bird/Sprites/flying-creature-cycle-skin4.png" id="4_6nk3w"]
[ext_resource type="Texture2D" uid="uid://canfc1fhp0tby" path="res://Sunny Land Collection Files/Assets/Characters/Enemies and NPC/flying-bird/Sprites/flying-creature-cycle-skin5.png" id="5_w265n"]
[ext_resource type="Texture2D" uid="uid://chq0xq3bs165h" path="res://Sunny Land Collection Files/Assets/Characters/Enemies and NPC/flying-bird/Sprites/flying-creature-cycle-skin6.png" id="6_l2t0q"]
[ext_resource type="Texture2D" uid="uid://c6btjns2dhf2" path="res://Sunny Land Collection Files/Assets/Characters/Enemies and NPC/flying-bird/Sprites/flying-creature-cycle-skin7.png" id="7_vab2h"]

[sub_resource type="GDScript" id="GDScript_yr30m"]
script/source = "extends CharacterBody2D

@onready var animated_sprite = $AnimatedSprite2D

# Speed relative to background
var background_scroll_speed = 100.0  # Match your background speed
var bird_relative_speed = 120.0  # How much faster than background
var actual_fly_speed = 0.0

# Screen bounds
var spawn_x = -50.0
var despawn_x = 0.0

# Natural movement
var bob_amplitude = 15.0
var bob_speed = 3.0
var time = 0.0

# Variety
#var bird_colors = [
	#Color(1.0, 1.0, 1.0),     # White bird
	#Color(0.85, 0.7, 0.5),    # Brown bird
	#Color(0.6, 0.6, 0.6),     # Gray bird
#]

func _ready() -> void:
	animated_sprite.play(\"Flying\")
	
	# Get screen width
	despawn_x = get_viewport_rect().size.x + 50
	
	# Random bird color
	#animated_sprite.modulate = bird_colors[randi() % bird_colors.size()]
	
	# Random size
	var scale_factor = randf_range(0.8, 1.2)
	animated_sprite.scale = Vector2(scale_factor, scale_factor)
	
	reset_bird()

func _process(delta: float) -> void:
	# Move bird (background scrolls left at 100, bird flies right at ~220)
	position.x += actual_fly_speed * delta
	
	# Natural bobbing
	time += delta * bob_speed
	var bob_offset = sin(time) * bob_amplitude
	position.y += bob_offset * delta
	
	# Slight tilt based on bobbing (looks more natural)
	animated_sprite.rotation_degrees = bob_offset * 0.5
	
	# Respawn when off-screen
	if position.x > despawn_x:
		reset_bird()

func reset_bird():
	# Respawn on left
	position.x = spawn_x
	position.y = randf_range(60, 280)
	
	# Calculate actual speed (background + bird's own speed)
	bird_relative_speed = randf_range(100, 180)
	actual_fly_speed = background_scroll_speed + bird_relative_speed
	
	# Randomize movement
	bob_speed = randf_range(2.0, 4.5)
	bob_amplitude = randf_range(8.0, 18.0)
	time = randf_range(0, TAU)
	
	# Random color each spawn
	#animated_sprite.modulate = bird_colors[randi() % bird_colors.size()]
"

[sub_resource type="SpriteFrames" id="SpriteFrames_f430k"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("1_yr30m")
}, {
"duration": 1.0,
"texture": ExtResource("2_2o5yp")
}, {
"duration": 1.0,
"texture": ExtResource("3_k3v35")
}, {
"duration": 1.0,
"texture": ExtResource("4_6nk3w")
}, {
"duration": 1.0,
"texture": ExtResource("5_w265n")
}, {
"duration": 1.0,
"texture": ExtResource("6_l2t0q")
}, {
"duration": 1.0,
"texture": ExtResource("7_vab2h")
}],
"loop": true,
"name": &"Flying",
"speed": 5.0
}]

[node name="Bird" type="CharacterBody2D"]
script = SubResource("GDScript_yr30m")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
position = Vector2(0, -3)
sprite_frames = SubResource("SpriteFrames_f430k")
animation = &"Flying"
autoplay = "Flying"
